services:
  mem0-api:
    build:
      context: ./server
    container_name: mem0-api
    ports:
      - "8000:8000"
    environment:
      # ‡πÉ‡∏ä‡πâ Config API ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö main.py ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏õ)
      - VECTOR_STORE=qdrant
      - QDRANT_URL=http://qdrant:6333
      - QDRANT_COLLECTION=mem0
      - OPENAI_API_KEY=sk-WIqY-Eg2u9q24jnZ9jbFHw
      - OPENAI_BASE_URL=https://tokenmind.abdul.in.th/v1
      - OPENAI_MODEL=ptm-gpt-oss-120b
      - HISTORY_DB_PATH=/app/history/history.db
    volumes:
      # ‡πÄ‡∏û‡∏¥‡πà‡∏° volume ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö history database
      - history_data:/app/history
    depends_on:
      - qdrant
      - ollama

  qdrant:
    image: qdrant/qdrant:v1.8.3
    container_name: qdrant
    ports:
      - "6333:6333"
    volumes:
      - qdrant_data:/qdrant/storage

  # ‡πÄ‡∏û‡∏¥‡πà‡∏° Ollama service
  ollama:
    image: ollama/ollama:latest
    container_name: ollama
    ports:
      - "11435:11435"
    volumes:
      - ollama_data:/root/.ollama
    # ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ GPU ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
    # deploy:
    #   resources:
    #     reservations:
    #       devices:
    #         - driver: nvidia
    #           count: 1
    #           capabilities: [gpu]

  # üëá ‡∏™‡πà‡∏ß‡∏ô UI Dashboard (Port 3000) ‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏£‡∏Å
  openmemory-ui:
    build:
      context: ./openmemory/ui
    container_name: openmemory-ui
    ports:
      - "3000:3000"
    environment:
      - MEM0_API_URL=http://mem0-api:8000
    depends_on:
      - mem0-api

volumes:
  qdrant_data:
  history_data:
  ollama_data: